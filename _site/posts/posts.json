[
  {
    "path": "posts/2022-01-01-different-basemaps-in-leaflet-r/",
    "title": "Different Basemaps in leaflet (R)",
    "description": "A sample of different basemaps that can be used in leaflet.",
    "author": [
      {
        "name": "Jeffrey Schmid-Paz",
        "url": {}
      }
    ],
    "date": "2022-01-01",
    "categories": [],
    "contents": "\r\nDuring work I learned, that showing people insights from data in a geographic form is extremely intuitive and accessible for all kind of professionals. While doing several reports in different tools I looked for the best suitable basemaps to carry my analysis over to the people who need to look at the report. I hope that a simple post to show how to use different basemaps or background layers in leaflet for R serves you well in a similar need as I had. Please note, that I myself am not a trained geographer, which is why the maps used here focus more on those that a general public would use. Also, most of the services, restrict the number of accesses made per user such that the explanations here are only useful if you plan to make simple maps for yourself or a limited number of other users.\r\nPreparations\r\nSo the first step in R of course would be to load the necessary packages in R.\r\n\r\n\r\nlibrary(leaflet)\r\nlibrary(sf) # to create a point to draw on the map\r\n\r\n\r\n\r\n\r\n\r\n\r\nFirst let’s define an arbitrary coordinate to center our map on using the sf package. For this example I go with the city of Lucerne in Switzerland.\r\n\r\n\r\nlucerne <- st_sfc(st_point(x = c(8.31, 47.05 )))\r\nst_crs(lucerne) <-  'WGS84'\r\n\r\n\r\n\r\nCreate maps\r\nEveryone who used leafletin R before, knows the default OpenStreetMap layer. For this, you simply leave the addTiles() function, which adds a base layer, empty such that the defaults are used\r\n\r\n\r\nleaflet() %>% \r\n  addTiles() %>% \r\n  addMarkers(data = lucerne)\r\n\r\n\r\n\r\n{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"http://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"http://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[47.05,8.31,null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},null,null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[47.05,47.05],\"lng\":[8.31,8.31]}},\"evals\":[],\"jsHooks\":[]}\r\nUsing the addProviderTiles() function ue can conveniently choose among several background maps. See http://leaflet-extras.github.io/leaflet-providers/preview/ for a neat overview of all the included maps.\r\n\r\n\r\nleaflet() %>% \r\n  addProviderTiles(provider = \"Stamen.Terrain\") %>% \r\n  addMarkers(data = lucerne)\r\n\r\n\r\n\r\n{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"Stamen.Terrain\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addMarkers\",\"args\":[47.05,8.31,null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},null,null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[47.05,47.05],\"lng\":[8.31,8.31]}},\"evals\":[],\"jsHooks\":[]}\r\nleaflet however allows pretty much any open available XYZ (Tiled web map) to be used as background. Below, I provide a function call for you to see, how the practical implementation in a script works. A great source of basemaps may be governmental agencies. For Switzerland the federal agency swisstopo offers a broad range of such maps\r\n\r\n\r\nleaflet() %>% \r\n  addTiles(urlTemplate = \"https://wmts20.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg\",\r\n           attribution = '&copy; <a href=\"https://www.geo.admin.ch/de/about-swiss-geoportal/impressum.html#copyright\">swisstopo<\/a>') %>% \r\n  addMarkers(data = lucerne)\r\n\r\n\r\n\r\n{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://wmts20.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://www.geo.admin.ch/de/about-swiss-geoportal/impressum.html#copyright\\\">swisstopo<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[47.05,8.31,null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},null,null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[47.05,47.05],\"lng\":[8.31,8.31]}},\"evals\":[],\"jsHooks\":[]}\r\nIn the function call you have to provide the URL of the XYZ tile as value for the urlTemplate argument. Make sure that the CRSs of your XYZ tile map and your leaflet object match (i.e. typically WGS84).\r\nList of Services\r\n\r\n\r\n\r\nHere is a short list of basemaps i personally thought are useful. Note that some maps may cover only limited areas. I hope i can extend the list over the months to come. In the list, I also provided a suggested attribution to include when you use them with fair use terms. However, I refuse to take any responsibility for any legal challenges you may face from using the mentioned maps in this blog post in any of your use cases you may have.\r\nRoads\r\nService\r\nLink (copy & paste into addTiles())\r\nSuggested Attribution\r\nPreview\r\nGoogle Maps\r\nhttps://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}\r\n© Google Maps\r\n\r\nswisstopo\r\nhttps://wmts20.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg\r\n© swisstopo\r\n\r\nSatellite Imagery\r\nService\r\nLink (copy & paste into addTiles())\r\nSuggested Attribution\r\nPreview\r\nGoogle Maps\r\nhttps://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}\r\n© Google Maps\r\n\r\nswisstopo\r\nhttps://wmts20.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg\r\n© swisstopo\r\n\r\nHybrid maps\r\nService\r\nLink (copy & paste into addTiles())\r\nSuggested Attribution\r\nPreview\r\nGoogle Maps\r\nhttps://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}\r\n© Google Maps\r\n\r\nIf you happen to know some other great basemaps to be used or see any errors, feel free to leave a comment or open an issue over at the github repository of this website.\r\nR Session Info\r\n\r\n\r\nsessionInfo()\r\n\r\n\r\nR version 4.1.1 (2021-08-10)\r\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\r\nRunning under: Windows 10 x64 (build 19043)\r\n\r\nMatrix products: default\r\n\r\nlocale:\r\n[1] LC_COLLATE=English_Switzerland.1252 \r\n[2] LC_CTYPE=English_Switzerland.1252   \r\n[3] LC_MONETARY=English_Switzerland.1252\r\n[4] LC_NUMERIC=C                        \r\n[5] LC_TIME=English_Switzerland.1252    \r\n\r\nattached base packages:\r\n[1] stats     graphics  grDevices utils     datasets  methods  \r\n[7] base     \r\n\r\nother attached packages:\r\n[1] sf_1.0-5        leaflet_2.0.4.1\r\n\r\nloaded via a namespace (and not attached):\r\n [1] tidyselect_1.1.1        terra_1.4-22           \r\n [3] xfun_0.25               purrr_0.3.4            \r\n [5] lattice_0.20-44         mapview_2.10.0         \r\n [7] colorspace_2.0-2        vctrs_0.3.8            \r\n [9] generics_0.1.0          leaflet.providers_1.9.0\r\n[11] htmltools_0.5.2         stats4_4.1.1           \r\n[13] yaml_2.2.1              base64enc_0.1-3        \r\n[15] utf8_1.2.2              rlang_0.4.11           \r\n[17] e1071_1.7-8             pillar_1.6.2           \r\n[19] glue_1.4.2              DBI_1.1.1              \r\n[21] sp_1.4-5                lifecycle_1.0.0        \r\n[23] stringr_1.4.0           munsell_0.5.0          \r\n[25] raster_3.4-13           htmlwidgets_1.5.4      \r\n[27] codetools_0.2-18        memoise_2.0.0          \r\n[29] evaluate_0.14           knitr_1.33             \r\n[31] callr_3.7.0             fastmap_1.1.0          \r\n[33] ps_1.6.0                crosstalk_1.2.0        \r\n[35] class_7.3-19            fansi_0.5.0            \r\n[37] leafem_0.1.6            Rcpp_1.0.7             \r\n[39] KernSmooth_2.23-20      scales_1.1.1           \r\n[41] classInt_0.4-3          satellite_1.0.4        \r\n[43] cachem_1.0.5            webshot_0.5.2          \r\n[45] jsonlite_1.7.2          distill_1.3            \r\n[47] png_0.1-7               digest_0.6.27          \r\n[49] stringi_1.7.3           processx_3.5.2         \r\n[51] dplyr_1.0.7             grid_4.1.1             \r\n[53] tools_4.1.1             magrittr_2.0.1         \r\n[55] proxy_0.4-26            tibble_3.1.3           \r\n[57] crayon_1.4.1            pkgconfig_2.0.3        \r\n[59] downlit_0.4.0           ellipsis_0.3.2         \r\n[61] rmarkdown_2.11          R6_2.5.0               \r\n[63] units_0.7-2             compiler_4.1.1         \r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-01-01-different-basemaps-in-leaflet-r/maps/swisstopo_color.png",
    "last_modified": "2022-01-01T16:15:12+01:00",
    "input_file": {},
    "preview_width": 992,
    "preview_height": 744
  }
]
